<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Code Reader</title>
<style>
    #video {
        width: 100%;
        max-width: 600px;
        margin: auto;
        display: block;
    }
</style>
</head>
<body>
<video id="video" autoplay></video>
<select id="cameraSelect"></select>
<script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
<script>
    const video = document.getElementById('video');
    const cameraSelect = document.getElementById('cameraSelect');

    // Use Instascan for QR code scanning
    const scanner = new Instascan.Scanner({ video: video });
    
    // Populate camera select dropdown
    Instascan.Camera.getCameras().then(function (cameras) {
        if (cameras.length > 0) {
            cameras.forEach(function(camera, index) {
                const option = document.createElement('option');
                option.value = index;
                option.text = camera.name || `Camera ${index + 1}`;
                cameraSelect.appendChild(option);
            });
            // Start scanning with default camera
            scanner.start(cameras[0]);
        } else {
            console.error('No cameras found.');
            alert('No cameras found.');
        }
    }).catch(function (e) {
        console.error(e);
        alert('Error accessing cameras.');
    });

    // Change camera when selection changes
    cameraSelect.addEventListener('change', function() {
        const selectedCameraIndex = cameraSelect.value;
        Instascan.Camera.getCameras().then(function (cameras) {
            scanner.stop();
            scanner.start(cameras[selectedCameraIndex]);
        }).catch(function (e) {
            console.error(e);
            alert('Error accessing cameras.');
        });
    });

    scanner.addListener('scan', function (content) {
        console.log('Scanned: ' + content);
        // Do something with the scanned content
        alert('Scanned QR code: ' + content);
    });
</script>
</body>
</html>
